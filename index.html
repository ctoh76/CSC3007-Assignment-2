<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>Assignment 2</h1>
    <table>
        <tr>
            <th>Year</th>
        </tr>
    </table>

    <svg id="chart" viewBox="0 0 960 500"></svg>
    

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- <script src="app2.js" defer></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>

        var data1 = {
            resource_id: '83c21090-bd19-4b54-ab6b-d999c251edcf', // the resource id
        };
        $.ajax({
            url: 'https://data.gov.sg/api/action/datastore_search',
            data: data1,
            dataType: 'json',
            success: function (data1) {
                // Copyright 2021 Observable, Inc.
                // Released under the ISC license.
                // https://observablehq.com/@d3/diverging-bar-chart

                // console.log(data.result.records)
                //alert('Total results found: ' + data.result.total)
                // getResponse(data.result.records);

                //Store year
                // const value = [...new Set(data.result.records.map(record => record.year))];
                // for (i in value) {
                //     year = value[i];
                //     data[year] = data.result.records.filter(relevantYear => {
                //         return relevantYear.i === year
                //     })
                // }
                //console.log(data.result.records[2020]);
                var data = [
                    { student: "Alfred", score: 65 },
                    { student: "Bernard", score: 35 },
                    { student: "Christine", score: 75 }];

                var margin = { top: 20, right: 20, bottom: 40, left: 40 },
                    width = 960 - margin.left - margin.right,
                    height = 500 - margin.top - margin.bottom;

                var chart = d3.select("#chart")
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                // Add scales
                var xScale = d3.scaleBand()
                    .domain(data.map(function (d) { return d.student; }))
                    .rangeRound([0, width])
                    .padding(0.1);

                var yScale = d3.scaleLinear()
                    .domain([0, 100])
                    .rangeRound([height, 0]);

                // Add x-axis
                chart.append("g")
                    .attr("class", "axis axis-x")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(xScale));

                // Add y-axis
                chart.append("g")
                    .attr("class", "axis axis-y")
                    .call(d3.axisLeft(yScale).ticks(10));

                // Append rectangles
                chart.selectAll("rect")
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("x", function (d) { return xScale(d.student); })
                    .attr("y", function (d) { return yScale(d.score); })
                    .attr("width", function (d) { return xScale.bandwidth(); })
                    .attr("height", function (d) { return height - yScale(d.score); })
                    .attr("class", "svgRect");


                // console.log(data)
                // for (record in data.result.records){
                //     console.log(data.result.records[record].level_2);
                // }
            }
        });


    </script>
</body>

</html>